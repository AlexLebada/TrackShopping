{'agent': {'messages': [AIMessage(content='', additional_kwargs={'tool_calls': [{'id': 'call_nqIuBrZdCFmoCDN3jG1iDTS4', 'function': {'arguments': '{"collection_name":"receipts"}', 'name': 'update_display_read'}, 'type': 'function'}], 'refusal': None}, response_metadata={'token_usage': {'completion_tokens': 18, 'prompt_tokens': 377, 'total_tokens': 395, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 0}}, 'model_name': 'gpt-4o-2024-08-06', 'system_fingerprint': 'fp_fee4aaf18f', 'finish_reason': 'tool_calls', 'logprobs': None}, id='run-6da017c5-eae3-45ed-a941-6bb938fee137-0', tool_calls=[{'name': 'update_display_read', 'args': {'collection_name': 'receipts'}, 'id': 'call_nqIuBrZdCFmoCDN3jG1iDTS4', 'type': 'tool_call'}], usage_metadata={'input_tokens': 377, 'output_tokens': 18, 'total_tokens': 395, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}})]}}
----
{'tools': {'messages': [ToolMessage(content='["data_extracted:", {"yearly_cost": {"name": "yearly_cost", "description": "current year", "value": 10, "collection": "receipts", "tool": "get_receipts_info", "display": 1}, "monthly_cost": {"name": "monthly_cost", "description": "last 2 months", "value": 0, "collection": "receipts", "tool": "get_receipts_info", "display": 1}}]', name='update_display_read', id='88ec2845-2769-4206-8c6a-cda4ad197d59', tool_call_id='call_nqIuBrZdCFmoCDN3jG1iDTS4')]}}
----
{'agent': {'messages': [AIMessage(content='', additional_kwargs={'tool_calls': [{'id': 'call_ag88092qVb4vTsSjjQcpDC9Q', 'function': {'arguments': '{}', 'name': 'current_date'}, 'type': 'function'}], 'refusal': None}, response_metadata={'token_usage': {'completion_tokens': 11, 'prompt_tokens': 505, 'total_tokens': 516, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 0}}, 'model_name': 'gpt-4o-2024-08-06', 'system_fingerprint': 'fp_fee4aaf18f', 'finish_reason': 'tool_calls', 'logprobs': None}, id='run-75517c85-2731-4efe-af55-977530bde750-0', tool_calls=[{'name': 'current_date', 'args': {}, 'id': 'call_ag88092qVb4vTsSjjQcpDC9Q', 'type': 'tool_call'}], usage_metadata={'input_tokens': 505, 'output_tokens': 11, 'total_tokens': 516, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}})]}}
----
{'tools': {'messages': [ToolMessage(content='2025-02-21', name='current_date', id='5db63fce-44b5-4921-a2b4-a2d76f0576e0', tool_call_id='call_ag88092qVb4vTsSjjQcpDC9Q')]}}
----
{'agent': {'messages': [AIMessage(content='', additional_kwargs={'tool_calls': [{'id': 'call_fKWielJsmOP8jlaxCN1x2AfE', 'function': {'arguments': '{"start_date": "2025-01-01", "end_date": "2025-12-31"}', 'name': 'get_receipts_info'}, 'type': 'function'}, {'id': 'call_bAwuAtEBVje5QOpcPTB1bVRG', 'function': {'arguments': '{"start_date": "2024-12-01", "end_date": "2025-01-31"}', 'name': 'get_receipts_info'}, 'type': 'function'}], 'refusal': None}, response_metadata={'token_usage': {'completion_tokens': 81, 'prompt_tokens': 529, 'total_tokens': 610, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 0}}, 'model_name': 'gpt-4o-2024-08-06', 'system_fingerprint': 'fp_fee4aaf18f', 'finish_reason': 'tool_calls', 'logprobs': None}, id='run-0ec86731-7013-414c-8e11-b27b71ae9dbc-0', tool_calls=[{'name': 'get_receipts_info', 'args': {'start_date': '2025-01-01', 'end_date': '2025-12-31'}, 'id': 'call_fKWielJsmOP8jlaxCN1x2AfE', 'type': 'tool_call'}, {'name': 'get_receipts_info', 'args': {'start_date': '2024-12-01', 'end_date': '2025-01-31'}, 'id': 'call_bAwuAtEBVje5QOpcPTB1bVRG', 'type': 'tool_call'}], usage_metadata={'input_tokens': 529, 'output_tokens': 81, 'total_tokens': 610, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}})]}}
----
{'tools': {'messages': [ToolMessage(content='45.34', name='get_receipts_info', id='8a5fbaaf-a449-4838-a9f5-600210e6573d', tool_call_id='call_fKWielJsmOP8jlaxCN1x2AfE'), ToolMessage(content='45.34', name='get_receipts_info', id='e0c99a32-e720-4abb-93b7-49e0802195d5', tool_call_id='call_bAwuAtEBVje5QOpcPTB1bVRG')]}}
----
{'agent': {'messages': [AIMessage(content='', additional_kwargs={'tool_calls': [{'id': 'call_DwY7Vs5Nwi0UKFJRv2usigvd', 'function': {'arguments': '{}', 'name': 'update_display_write'}, 'type': 'function'}], 'refusal': None}, response_metadata={'token_usage': {'completion_tokens': 12, 'prompt_tokens': 629, 'total_tokens': 641, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 0}}, 'model_name': 'gpt-4o-2024-08-06', 'system_fingerprint': 'fp_fee4aaf18f', 'finish_reason': 'tool_calls', 'logprobs': None}, id='run-beebbc70-88e0-4d70-a1d1-b57eee2c7f17-0', tool_calls=[{'name': 'update_display_write', 'args': {}, 'id': 'call_DwY7Vs5Nwi0UKFJRv2usigvd', 'type': 'tool_call'}], usage_metadata={'input_tokens': 629, 'output_tokens': 12, 'total_tokens': 641, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}})]}}
----
{'tools': {'messages': [ToolMessage(content='Error: 1 validation error for update_display_write\ndata_extracted\n  Field required [type=missing, input_value={}, input_type=dict]\n    For further information visit https://errors.pydantic.dev/2.10/v/missing\n Please fix your mistakes.', name='update_display_write', id='624e5623-0d48-4388-9c4d-965be384d3dc', tool_call_id='call_DwY7Vs5Nwi0UKFJRv2usigvd', status='error')]}}
----
{'agent': {'messages': [AIMessage(content='It seems there was an error while trying to update the display values. The data extracted needs to be properly formatted before writing. Let me correct that and try again.', additional_kwargs={'tool_calls': [{'id': 'call_s7e99qLYwksv5ftjmhTUbBR1', 'function': {'arguments': '{"data_extracted":{"yearly_cost":{"name":"yearly_cost","description":"current year","value":45.34,"collection":"receipts","tool":"get_receipts_info","display":1},"monthly_cost":{"name":"monthly_cost","description":"last 2 months","value":45.34,"collection":"receipts","tool":"get_receipts_info","display":1}}}', 'name': 'update_display_write'}, 'type': 'function'}], 'refusal': None}, response_metadata={'token_usage': {'completion_tokens': 126, 'prompt_tokens': 704, 'total_tokens': 830, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 0}}, 'model_name': 'gpt-4o-2024-08-06', 'system_fingerprint': 'fp_fee4aaf18f', 'finish_reason': 'tool_calls', 'logprobs': None}, id='run-5ec40297-9b56-4920-a994-fb9aaad6cda2-0', tool_calls=[{'name': 'update_display_write', 'args': {'data_extracted': {'yearly_cost': {'name': 'yearly_cost', 'description': 'current year', 'value': 45.34, 'collection': 'receipts', 'tool': 'get_receipts_info', 'display': 1}, 'monthly_cost': {'name': 'monthly_cost', 'description': 'last 2 months', 'value': 45.34, 'collection': 'receipts', 'tool': 'get_receipts_info', 'display': 1}}}, 'id': 'call_s7e99qLYwksv5ftjmhTUbBR1', 'type': 'tool_call'}], usage_metadata={'input_tokens': 704, 'output_tokens': 126, 'total_tokens': 830, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}})]}}
----
{'tools': {'messages': [ToolMessage(content='Successfully', name='update_display_write', id='cbb2b6a9-d2ec-484e-ba8d-9233eb666a9b', tool_call_id='call_s7e99qLYwksv5ftjmhTUbBR1')]}}
----
{'agent': {'messages': [AIMessage(content='The displayed values for the collection "receipts" have been successfully updated. The yearly cost is now 45.34, and the monthly cost for the last two months is also 45.34.', additional_kwargs={'refusal': None}, response_metadata={'token_usage': {'completion_tokens': 43, 'prompt_tokens': 841, 'total_tokens': 884, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 0}}, 'model_name': 'gpt-4o-2024-08-06', 'system_fingerprint': 'fp_fee4aaf18f', 'finish_reason': 'stop', 'logprobs': None}, id='run-b0093eae-91d1-413d-9ebd-6ead36553c3c-0', usage_metadata={'input_tokens': 841, 'output_tokens': 43, 'total_tokens': 884, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}})]}}
----
Total Tokens: 3876
Prompt Tokens: 3585
Completion Tokens: 291
Total Cost (USD): $0.011872500000000001
