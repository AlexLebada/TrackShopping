{'agent': {'messages': [AIMessage(content='', additional_kwargs={'tool_calls': [{'id': 'call_fx1dkBYplWhIvxQOfyqIM6YO', 'function': {'arguments': '{"filename":"test_img.jpg","description":"Test image for processing","type":"image"}', 'name': 'add_raw_to_db'}, 'type': 'function'}], 'refusal': None}, response_metadata={'token_usage': {'completion_tokens': 30, 'prompt_tokens': 300, 'total_tokens': 330, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 0}}, 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_00428b782a', 'finish_reason': 'tool_calls', 'logprobs': None}, id='run-e07535d2-0a43-49bb-b31d-2ed9d50cd1ff-0', tool_calls=[{'name': 'add_raw_to_db', 'args': {'filename': 'test_img.jpg', 'description': 'Test image for processing', 'type': 'image'}, 'id': 'call_fx1dkBYplWhIvxQOfyqIM6YO', 'type': 'tool_call'}], usage_metadata={'input_tokens': 300, 'output_tokens': 30, 'total_tokens': 330, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}})]}}
----
{'tools': {'messages': [ToolMessage(content='["successfully added metadata", "document_id:67afd900fca1e136978dc100"]', name='add_raw_to_db', id='8b1027cd-de76-4f58-969d-03f98f1c2347', tool_call_id='call_fx1dkBYplWhIvxQOfyqIM6YO')]}}
----
{'agent': {'messages': [AIMessage(content='', additional_kwargs={'tool_calls': [{'id': 'call_JB7owsNSR6cco2uNySN6sioA', 'function': {'arguments': '{"filename":"test_img.jpg"}', 'name': 'agentic_extractor'}, 'type': 'function'}], 'refusal': None}, response_metadata={'token_usage': {'completion_tokens': 19, 'prompt_tokens': 361, 'total_tokens': 380, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 0}}, 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_00428b782a', 'finish_reason': 'tool_calls', 'logprobs': None}, id='run-28011658-b8a7-4c9f-a896-0fb290ead4f5-0', tool_calls=[{'name': 'agentic_extractor', 'args': {'filename': 'test_img.jpg'}, 'id': 'call_JB7owsNSR6cco2uNySN6sioA', 'type': 'tool_call'}], usage_metadata={'input_tokens': 361, 'output_tokens': 19, 'total_tokens': 380, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}})]}}
----
{'tools': {'messages': [ToolMessage(content="description='Receipt' date='unknown' type='image' fruits=[product(product_format='Mandarine-0.814-kg-9.12-7.51'), product(product_format='Punga verde-0.12-BUC-2.54-2.48'), product(product_format='Punga verde-0.12-BUC-2.54-2.48')] vegetables=[product(product_format='Ardei-0.212-kg-11.69-2.47'), product(product_format='Banan-0.212-kg-9.99-2.12')] shop_place='unknown' total_cost='45.34'", name='agentic_extractor', id='5bca0a11-d9a1-4b27-ac6d-9aa50e2a7ed6', tool_call_id='call_JB7owsNSR6cco2uNySN6sioA')]}}
----
{'agent': {'messages': [AIMessage(content='', additional_kwargs={'tool_calls': [{'id': 'call_N4nyOJSXCet3Sm8BpWgW5Xe4', 'function': {'arguments': '{"user":"Giorgio","date":"unknown","type":"receipt","fruits":["Mandarine","Punga verde","Punga verde"],"vegetables":["Ardei","Banan"],"shop_place":"unknown","document_id":"67afd900fca1e136978dc100","total_cost":"45.34"}', 'name': 'add_receipts'}, 'type': 'function'}], 'refusal': None}, response_metadata={'token_usage': {'completion_tokens': 78, 'prompt_tokens': 524, 'total_tokens': 602, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 0}}, 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_00428b782a', 'finish_reason': 'tool_calls', 'logprobs': None}, id='run-1666b7a3-f0e1-4474-8c55-9f1e981ea8c4-0', tool_calls=[{'name': 'add_receipts', 'args': {'user': 'Giorgio', 'date': 'unknown', 'type': 'receipt', 'fruits': ['Mandarine', 'Punga verde', 'Punga verde'], 'vegetables': ['Ardei', 'Banan'], 'shop_place': 'unknown', 'document_id': '67afd900fca1e136978dc100', 'total_cost': '45.34'}, 'id': 'call_N4nyOJSXCet3Sm8BpWgW5Xe4', 'type': 'tool_call'}], usage_metadata={'input_tokens': 524, 'output_tokens': 78, 'total_tokens': 602, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}})]}}
----
{'tools': {'messages': [ToolMessage(content='successfully added to database collection', name='add_receipts', id='047929f0-0f05-4321-898c-d191e6f30519', tool_call_id='call_N4nyOJSXCet3Sm8BpWgW5Xe4')]}}
----
{'agent': {'messages': [AIMessage(content='The receipt from the image "test_img.jpg" has been successfully processed and stored in the database. Here are the details:\n\n- **Fruits**: Mandarine, Punga verde (x2)\n- **Vegetables**: Ardei, Banan\n- **Total Cost**: $45.34\n- **Shop Place**: Unknown\n- **Date**: Unknown\n\nIf you need any further assistance, feel free to ask!', additional_kwargs={'refusal': None}, response_metadata={'token_usage': {'completion_tokens': 93, 'prompt_tokens': 616, 'total_tokens': 709, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 0}}, 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_00428b782a', 'finish_reason': 'stop', 'logprobs': None}, id='run-59bb6730-9265-4b01-89dd-f1681bfb66f8-0', usage_metadata={'input_tokens': 616, 'output_tokens': 93, 'total_tokens': 709, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}})]}}
----
Total Tokens: 3311
Prompt Tokens: 2953
Completion Tokens: 358
Total Cost (USD): $0.00065775
