{'agent': {'messages': [AIMessage(content='', additional_kwargs={'tool_calls': [{'id': 'call_qxYg1ws3SGUwNpV65OvLodE4', 'function': {'arguments': '{"type":"function"}', 'name': 'querying_db_blocks'}, 'type': 'function'}], 'refusal': None}, response_metadata={'token_usage': {'completion_tokens': 17, 'prompt_tokens': 653, 'total_tokens': 670, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 0}}, 'model_name': 'gpt-4o-2024-08-06', 'system_fingerprint': 'fp_eb9dce56a8', 'finish_reason': 'tool_calls', 'logprobs': None}, id='run-b7018abf-6a34-4ec0-b9dd-08abe7bf5584-0', tool_calls=[{'name': 'querying_db_blocks', 'args': {'type': 'function'}, 'id': 'call_qxYg1ws3SGUwNpV65OvLodE4', 'type': 'tool_call'}], usage_metadata={'input_tokens': 653, 'output_tokens': 17, 'total_tokens': 670, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}})]}}
----
{'tools': {'messages': [ToolMessage(content='["function list: ", [{"name": "get_periodical_cost", "description": "This query is used to retrieve total cost by given period.\\nCollections choices:  \\"receipts\\" for complete data or \\"non-receipts\\" for incomplete data, which was previously provided by user    \\nFormat date args: 2022-02-09 (year-month-day)\\n\\nArgs:    \\ncollection_name: str\\nstart_date: str\\nend_date: str\\nuser: str\\n\\n"}, {"name": "sum_two_numbers", "description": "This query is used to calculate the sum\\n\\nArgs:    \\na: float\\nb: float\\n"}]]', name='querying_db_blocks', id='ec5626b8-9d73-46e3-a1af-02056592177c', tool_call_id='call_qxYg1ws3SGUwNpV65OvLodE4')]}}
----
{'agent': {'messages': [AIMessage(content='', additional_kwargs={'tool_calls': [{'id': 'call_8XnjUH5J3BBLKkwSO7XkEftV', 'function': {'arguments': '{"collection_name":"weekly_cost","mode":"add"}', 'name': 'cache_file_read'}, 'type': 'function'}], 'refusal': None}, response_metadata={'token_usage': {'completion_tokens': 22, 'prompt_tokens': 821, 'total_tokens': 843, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 0}}, 'model_name': 'gpt-4o-2024-08-06', 'system_fingerprint': 'fp_eb9dce56a8', 'finish_reason': 'tool_calls', 'logprobs': None}, id='run-7a154c3d-7ba4-4fd4-9133-99bd162cf42d-0', tool_calls=[{'name': 'cache_file_read', 'args': {'collection_name': 'weekly_cost', 'mode': 'add'}, 'id': 'call_8XnjUH5J3BBLKkwSO7XkEftV', 'type': 'tool_call'}], usage_metadata={'input_tokens': 821, 'output_tokens': 22, 'total_tokens': 843, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}})]}}
----
{'tools': {'messages': [ToolMessage(content='["data_extracted:", {"yearly_cost": {"name": "yearly_cost", "description": "result of total amount of spending per current year", "value": 45.34, "args": "", "function": "get_receipts_info", "update": "daily", "display": 1}, "monthly_cost": {"name": "monthly_cost", "description": "result of  total amount of spending last 2 months", "value": 45.34, "args": "", "function": "get_receipts_info", "update": "daily", "display": 1}, "daily_cost": {"name": "daily_cost", "description": "result of total amount of spending today", "value": 0, "args": "", "function": "get_periodical_cost", "update": "daily", "display": 1}, "first_2_days_previous_month_cost": {"name": "first_2_days_previous_month_cost", "description": "result of total amount of spending first 2 days of the previous month", "value": 0, "args": "receipts", "function": "get_periodical_cost", "update": "never", "display": 1}}]', name='cache_file_read', id='d4ca6b71-9b72-453a-b49e-e1b9884d668d', tool_call_id='call_8XnjUH5J3BBLKkwSO7XkEftV')]}}
----
{'agent': {'messages': [AIMessage(content='', additional_kwargs={'tool_calls': [{'id': 'call_c1S6LAXS9NzCs4f1z3FOVMzN', 'function': {'arguments': '{}', 'name': 'current_date'}, 'type': 'function'}], 'refusal': None}, response_metadata={'token_usage': {'completion_tokens': 11, 'prompt_tokens': 1105, 'total_tokens': 1116, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 0}}, 'model_name': 'gpt-4o-2024-08-06', 'system_fingerprint': 'fp_eb9dce56a8', 'finish_reason': 'tool_calls', 'logprobs': None}, id='run-a554b596-d80e-470e-9248-c1ccef220fad-0', tool_calls=[{'name': 'current_date', 'args': {}, 'id': 'call_c1S6LAXS9NzCs4f1z3FOVMzN', 'type': 'tool_call'}], usage_metadata={'input_tokens': 1105, 'output_tokens': 11, 'total_tokens': 1116, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}})]}}
----
{'tools': {'messages': [ToolMessage(content='2025-02-28', name='current_date', id='76fe49b8-a19c-447d-9217-e8b54d534231', tool_call_id='call_c1S6LAXS9NzCs4f1z3FOVMzN')]}}
----
{'agent': {'messages': [AIMessage(content='', additional_kwargs={'tool_calls': [{'id': 'call_AQBKR5GkWov3L9qo52qtB9KN', 'function': {'arguments': '{"mode":"add"}', 'name': 'cache_file_write'}, 'type': 'function'}], 'refusal': None}, response_metadata={'token_usage': {'completion_tokens': 16, 'prompt_tokens': 1129, 'total_tokens': 1145, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 1024}}, 'model_name': 'gpt-4o-2024-08-06', 'system_fingerprint': 'fp_eb9dce56a8', 'finish_reason': 'tool_calls', 'logprobs': None}, id='run-47a99cb4-b937-46d4-aad7-29030ae09f39-0', tool_calls=[{'name': 'cache_file_write', 'args': {'mode': 'add'}, 'id': 'call_AQBKR5GkWov3L9qo52qtB9KN', 'type': 'tool_call'}], usage_metadata={'input_tokens': 1129, 'output_tokens': 16, 'total_tokens': 1145, 'input_token_details': {'audio': 0, 'cache_read': 1024}, 'output_token_details': {'audio': 0, 'reasoning': 0}})]}}
----
{'tools': {'messages': [ToolMessage(content="Error: 1 validation error for cache_file_write\ndata_extracted\n  Field required [type=missing, input_value={'mode': 'add'}, input_type=dict]\n    For further information visit https://errors.pydantic.dev/2.10/v/missing\n Please fix your mistakes.", name='cache_file_write', id='31dca871-e2c1-44c9-979b-22d23fc0d87f', tool_call_id='call_AQBKR5GkWov3L9qo52qtB9KN', status='error')]}}
----
{'agent': {'messages': [AIMessage(content='It seems there was an error while trying to add the new item to the cache file. Let me correct that and try again.', additional_kwargs={'tool_calls': [{'id': 'call_RoHHLj0GFZmCZtZisNxnfNt3', 'function': {'arguments': '{"mode":"add","data_extracted":{"weekly_cost":{"name":"weekly_cost","description":"calculates total amount of spending for the current week","value":0,"args":"(\'receipts\', \'2025-02-22\', \'2025-02-28\', \'Giorgio\')","function":"get_periodical_cost","update":"weekly","display":1}}}', 'name': 'cache_file_write'}, 'type': 'function'}], 'refusal': None}, response_metadata={'token_usage': {'completion_tokens': 117, 'prompt_tokens': 1213, 'total_tokens': 1330, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 1024}}, 'model_name': 'gpt-4o-2024-08-06', 'system_fingerprint': 'fp_eb9dce56a8', 'finish_reason': 'tool_calls', 'logprobs': None}, id='run-579a7cba-dafc-4afb-bb02-68d5bb6b0f7d-0', tool_calls=[{'name': 'cache_file_write', 'args': {'mode': 'add', 'data_extracted': {'weekly_cost': {'name': 'weekly_cost', 'description': 'calculates total amount of spending for the current week', 'value': 0, 'args': "('receipts', '2025-02-22', '2025-02-28', 'Giorgio')", 'function': 'get_periodical_cost', 'update': 'weekly', 'display': 1}}}, 'id': 'call_RoHHLj0GFZmCZtZisNxnfNt3', 'type': 'tool_call'}], usage_metadata={'input_tokens': 1213, 'output_tokens': 117, 'total_tokens': 1330, 'input_token_details': {'audio': 0, 'cache_read': 1024}, 'output_token_details': {'audio': 0, 'reasoning': 0}})]}}
----
{'tools': {'messages': [ToolMessage(content='Successfully', name='cache_file_write', id='04c21f05-cf8c-4967-8423-a43f5a05ab5e', tool_call_id='call_RoHHLj0GFZmCZtZisNxnfNt3')]}}
----
{'agent': {'messages': [AIMessage(content='The weekly spending analytics have been added and will be displayed on your interface. The data will be updated weekly.', additional_kwargs={'refusal': None}, response_metadata={'token_usage': {'completion_tokens': 24, 'prompt_tokens': 1341, 'total_tokens': 1365, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 1280}}, 'model_name': 'gpt-4o-2024-08-06', 'system_fingerprint': 'fp_eb9dce56a8', 'finish_reason': 'stop', 'logprobs': None}, id='run-4e14638e-83c7-4e24-b3cc-0f367c4ab670-0', usage_metadata={'input_tokens': 1341, 'output_tokens': 24, 'total_tokens': 1365, 'input_token_details': {'audio': 0, 'cache_read': 1280}, 'output_token_details': {'audio': 0, 'reasoning': 0}})]}}
----
