{'agent': {'messages': [AIMessage(content='', additional_kwargs={'tool_calls': [{'id': 'call_3F5DarVPoD7mpPR7527pWv9f', 'function': {'arguments': '{}', 'name': 'querying_collections'}, 'type': 'function'}], 'refusal': None}, response_metadata={'token_usage': {'completion_tokens': 13, 'prompt_tokens': 696, 'total_tokens': 709, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 0}}, 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_709714d124', 'finish_reason': 'tool_calls', 'logprobs': None}, id='run-198ab9c5-a3fa-4161-940d-15b73f886aa7-0', tool_calls=[{'name': 'querying_collections', 'args': {}, 'id': 'call_3F5DarVPoD7mpPR7527pWv9f', 'type': 'tool_call'}], usage_metadata={'input_tokens': 696, 'output_tokens': 13, 'total_tokens': 709, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}})]}}
----
{'tools': {'messages': [ToolMessage(content='["Collection list: ", [{"name": "users", "description": "Collection with user information.\\nHas the following keys, with values format and type:\\nuser: as str\\ninfo: details given like email etc, as str\\nscope: for what user wants to use this app, as str\\nregister_date: as str "}, {"name": "receipts", "description": "Collection with user\'s complete receipts, with main informations extracted.\\nHas the following keys, with values format and type:\\nuser: as str\\ndate(format: 2023-10-05): as str\\nfruits(product format:name-quantity-unit-price unit-total price), as a list of string with products \\nvegetables(same format and type as fruits)\\nshop_place: store/market where bought from, as str\\ndocument_id: id of the raw file from which this document has been extracted, as a string\\ntotal_cost: total amount of the receipt(includes also other products), as int"}, {"name": "non-receipts", "description": "Collection with user\'s incomplete receipts/other formats, with main informations extracted.\\nHas the following keys, with values format and type:\\nuser: as str\\ndate(format: 2023-10-05): as str\\nfruits(product format:name-quantity-unit-price unit-total price), as a list of string with products \\nvegetables(same format and type as fruits)\\nshop_place: store/market where bought from, as str\\ndocument_id: id of the raw file from which this document has been extracted, as a string\\ntotal_cost: total amount of the receipt(includes also other products), as int"}]]', name='querying_collections', id='69161896-f4ab-43f5-92a9-d90cc70a1f84', tool_call_id='call_3F5DarVPoD7mpPR7527pWv9f')]}}
----
{'agent': {'messages': [AIMessage(content='', additional_kwargs={'tool_calls': [{'id': 'call_0YUiwQS5XgWEKWFaItJuA38g', 'function': {'arguments': '{"collection_name": "receipts", "description": "Retrieve all fruits bought by the user", "request": "return all fruits from receipts"}', 'name': 'agentic_retriever_data'}, 'type': 'function'}, {'id': 'call_oxoYf6oP17lxxfBXOvSYR2CO', 'function': {'arguments': '{"collection_name": "non-receipts", "description": "Retrieve all fruits bought by the user", "request": "return all fruits from non-receipts"}', 'name': 'agentic_retriever_data'}, 'type': 'function'}], 'refusal': None}, response_metadata={'token_usage': {'completion_tokens': 98, 'prompt_tokens': 1074, 'total_tokens': 1172, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 0}}, 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_709714d124', 'finish_reason': 'tool_calls', 'logprobs': None}, id='run-64c2d27b-1bcb-4073-86f7-6d82197d10f5-0', tool_calls=[{'name': 'agentic_retriever_data', 'args': {'collection_name': 'receipts', 'description': 'Retrieve all fruits bought by the user', 'request': 'return all fruits from receipts'}, 'id': 'call_0YUiwQS5XgWEKWFaItJuA38g', 'type': 'tool_call'}, {'name': 'agentic_retriever_data', 'args': {'collection_name': 'non-receipts', 'description': 'Retrieve all fruits bought by the user', 'request': 'return all fruits from non-receipts'}, 'id': 'call_oxoYf6oP17lxxfBXOvSYR2CO', 'type': 'tool_call'}], usage_metadata={'input_tokens': 1074, 'output_tokens': 98, 'total_tokens': 1172, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}})]}}
----
{'tools': {'messages': [ToolMessage(content="('Documents retrieved: ', [{'_id': ObjectId('67afbf4cce8159cfc325e716'), 'fruits': ['MANDARIN-0.814-KG-9.22-7.51', 'PUNGA VERDE-0.12-buc-0.12-0.12', 'FM MARCU-1.000-BUC-8.39-8.39']}, {'_id': ObjectId('67afcc2cff554af0a759c52b'), 'fruits': ['Mandarine-0.814-kg-9.12-7.51', 'Punga verde-0.12-BUC-2.54-2.48', 'Punga verde-0.12-BUC-2.54-2.48']}, {'_id': ObjectId('67afd47ffaab0ac45fb17c20'), 'fruits': ['bananas']}, {'_id': ObjectId('67afd90cfca1e136978dc102'), 'fruits': ['Mandarine', 'Punga verde', 'Punga verde']}, {'_id': ObjectId('67b3a765e5d447c393972868'), 'fruits': []}])", name='agentic_retriever_data', id='3566525c-5345-4141-9090-a3c3dde317c2', tool_call_id='call_0YUiwQS5XgWEKWFaItJuA38g'), ToolMessage(content='["Documents retrieved: ", []]', name='agentic_retriever_data', id='ae49075d-e741-4710-83f8-a5ea2729ddad', tool_call_id='call_oxoYf6oP17lxxfBXOvSYR2CO')]}}
----
{'agent': {'messages': [AIMessage(content='Here are the fruits that were bought:\n\nFrom receipts:\n1. MANDARIN - 0.814 KG - 9.22 - 7.51\n2. PUNGA VERDE - 0.12 buc - 0.12 - 0.12\n3. FM MARCU - 1.000 BUC - 8.39 - 8.39\n4. Mandarine - 0.814 kg - 9.12 - 7.51\n5. Punga verde - 0.12 BUC - 2.54 - 2.48\n6. Punga verde - 0.12 BUC - 2.54 - 2.48\n7. Bananas\n8. Mandarine\n9. Punga verde\n10. Punga verde\n\nFrom non-receipts: No fruits were recorded.', additional_kwargs={'refusal': None}, response_metadata={'token_usage': {'completion_tokens': 183, 'prompt_tokens': 1457, 'total_tokens': 1640, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 1024}}, 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_709714d124', 'finish_reason': 'stop', 'logprobs': None}, id='run-aa2b00b1-bff5-4d0f-a338-d9483fd8cfb2-0', usage_metadata={'input_tokens': 1457, 'output_tokens': 183, 'total_tokens': 1640, 'input_token_details': {'audio': 0, 'cache_read': 1024}, 'output_token_details': {'audio': 0, 'reasoning': 0}})]}}
----
Total Tokens: 4372
Prompt Tokens: 3811
Completion Tokens: 561
Total Cost (USD): $0.00083145
